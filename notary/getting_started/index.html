<!-- Page generated 2020-07-16 21:49:37 +0900 -->
<!-- Logic for 'edit this button'


    

    

    

    

    

    

    

    

-->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <style type="text/css">
      @charset "UTF-8";
      [ng\:cloak],
      [ng-cloak],
      [data-ng-cloak],
      [x-ng-cloak],
      .ng-cloak,
      .x-ng-cloak,
      .ng-hide:not(.ng-hide-animate) {
          display: none !important;
      }

      ng\:form {
          display: block;
      }
  </style>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WL2QLG5');</script>

  
  <!-- favicon -->
  <link rel="icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta name="msapplication-TileImage" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico">
  <link rel="apple-touch-icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta property="og:image" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
  <!-- metadata -->
  <meta property="og:type" content="website"/>
  <meta property="og:updated_time" itemprop="dateUpdated" content="2020-07-16T21:49:37+09:00"/>
  <meta property="og:image" itemprop="image primaryImageOfPage" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:domain" content="docs.docker.com"/>
  <meta name="twitter:site" content="@docker_docs"/>
  <meta name="twitter:url" content="https://twitter.com/docker_docs"/>
  <meta name="twitter:title" itemprop="title name" content="Notary をはじめよう"/>
  <meta name="twitter:description" property="og:description" itemprop="description" content="This document describes basic use of the Notary CLI as a tool supporting Docker Content Trust. For more advanced use cases, you must run your own Notary service. Read the..." />
  <meta name="twitter:image:src" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:image:alt" content="Docker ドキュメント"/>
  <meta property="article:published_time" itemprop="datePublished" content="2020-07-16T21:49:37+09:00"/>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="docker, Notary, notary-client, docker content trust, content trust">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/font-awesome.min.css">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/bootstrap.min.css">
  <link id="pygments" rel="stylesheet" href="/docs.docker.jp.onthefly/css/pygments/perldoc.css">
  <link id="pagestyle" rel="stylesheet" href="/docs.docker.jp.onthefly/css/style.css">

  <!-- Go get "Open Sans" font from Google -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <!-- SEO stuff -->
  <title>Notary をはじめよう | Docker ドキュメント</title>
  <meta property="og:title" content="Notary をはじめよう" />
  <meta property="og:locale" content="ja_JP" />
  <meta name="description" content="Performing basic operation to use Notary in tandem with Docker Content Trust." />
  <meta property="og:description" content="Performing basic operation to use Notary in tandem with Docker Content Trust." />
  <link rel="canonical" href="/notary/getting_started/" />
  <meta property="og:url" content="https://docs.docker.com/notary/getting_started/" />
  <meta property="og:site_name" content="Docker ドキュメント" />
  <script type="application/ld+json">{"@context":"http://schema.org","@type":"WebPage","headline":"Notary をはじめよう","description":"Performing basic operation to use Notary in tandem with Docker Content Trust.","url":"https://docs.docker.com/notary/getting_started/"}</script>
  <!-- END SEO STUFF -->
  
</head>


    <body ng-app="Docker" ng-controller="DockerController" class="colums">
    <header>
        <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/docs.docker.jp.onthefly/">
                <img class="logo" src="/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs">
            </a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="logo-mobile">
    <a href="/docs.docker.jp.onthefly/">
        <img src="/docs.docker.jp.onthefly/images/docker-icon.svg" alt="Docker Docs" title="Docker Docs">
    </a>
</div>
<div class="search-form" id="search-div">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container hidden-sm hidden-xs">
    <div id="tabs">
        <ul class="tabs jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
    </div>
</div>

        </div>
    </div>
</nav>

    </header>
    <div class="wrapper right-open">
        <div class="container-fluid">
            <div class="row">
                <div class="col-body">
                    <main class="col-content content">
                        <section class="section">
                            
                            
                            <h1>Notary をはじめよう</h1> 
                            <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    5 分
  
</span>

                            
                            
<p>This document describes basic use of the Notary CLI as a tool supporting Docker
Content Trust. For more advanced use cases, you must
<a href="/docs.docker.jp.onthefly/notary/running_a_service/">run your own Notary service</a>. Read the
<a href="/docs.docker.jp.onthefly/notary/advanced_usage/">use the Notary client for advanced users</a> documentation.</p>

<h2 id="what-is-notary">Notary とは何か</h2>

<p>Notary is a tool for publishing and managing trusted collections of content.
Publishers can digitally sign collections and consumers can verify integrity
and origin of content. This ability is built on a straightforward key management
and signing interface to create signed collections and configure trusted publishers.</p>

<p>With Notary anyone can provide trust over arbitrary collections of data. Using
<a href="https://www.theupdateframework.com/">The Update Framework (TUF)</a>
as the underlying security framework, Notary takes care of the operations necessary
to create, manage, and distribute the metadata necessary to ensure the integrity and
freshness of your content.</p>

<h2 id="install-notary">Notary のインストール</h2>

<p>You can download precompiled notary binary for 64 bit Linux or macOS from the
Notary repository’s
<a href="https://github.com/docker/notary/releases">Releases page on Github</a>.</p>

<h2 id="understand-notary-naming">Understand Notary naming</h2>

<p>Notary では Globally Unique Names (GUN) というものを利用して、トラストイメージを識別します。
To
enable Notary to run in a multi-tenant fashion, you must use this format
when interacting with Docker Hub through the Notary client. When specifying
Docker image names for the Notary client, the GUN format is:</p>

<ul>
  <li>For official images (identifiable by the “Official Image” moniker), the
image name as displayed on Docker Hub, prefixed with <code class="highlighter-rouge">docker.io/library/</code>. For
example, if you would normally type <code class="highlighter-rouge">docker pull ubuntu</code> you must enter <code class="highlighter-rouge">notary
{cmd} docker.io/library/ubuntu</code>.</li>
  <li>For all other images, the image name as displayed on Docker Hub, prefixed by <code class="highlighter-rouge">docker.io</code>.</li>
</ul>

<p>The Docker Engine client takes care of these name expansions for you so do not
change the names you use with the Engine client or API. This is a requirement
only when interacting with the same Docker Hub repositories through the Notary
client.</p>

<h2 id="inspect-a-docker-hub-repository">Inspect a Docker Hub repository</h2>

<p>The most basic operation is listing the available signed tags in a repository.
The Notary client used in isolation does not know where the trust repositories
are located. So, you must provide the <code class="highlighter-rouge">-s</code> (or long form <code class="highlighter-rouge">--server</code>) flag to
tell the client which repository server it should communicate with.</p>

<p>The official Docker Hub Notary servers are located at
<code class="highlighter-rouge">https://notary.docker.io</code>. If you would like to use your own Notary server,
it is important to use the same or a newer
<a href="https://github.com/docker/notary/releases">Notary version</a>,
as the client for feature compatibility (ex: client version 0.2, server/signer version &gt;= 0.2).
Additionally, Notary stores your own signing keys,
and a cache of previously downloaded trust metadata in a directory, provided
with the <code class="highlighter-rouge">-d</code> flag. When interacting with Docker Hub repositories, you must
instruct the client to use the associated trust directory, which by default is
found at <code class="highlighter-rouge">.docker/trust</code> within the calling user’s home directory (failing to
use this directory may result in errors when publishing updates to your trust
data):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>notary <span class="nt">-s</span> https://notary.docker.io <span class="nt">-d</span> ~/.docker/trust list docker.io/library/alpine
   NAME                                 DIGEST                                SIZE <span class="o">(</span>BYTES<span class="o">)</span>    ROLE
<span class="nt">------------------------------------------------------------------------------------------------------</span>
  2.6      e9cec9aec697d8b9d450edd32860ecd363f2f3174c8338beb5f809422d182c63   1374           targets
  2.7      9f08005dff552038f0ad2f46b8e65ff3d25641747d3912e3ea8da6785046561a   1374           targets
  3.1      e876b57b2444813cd474523b9c74aacacc238230b288a22bccece9caf2862197   1374           targets
  3.2      4a8c62881c6237b4c1434125661cddf09434d37c6ef26bf26bfaef0b8c5e2f05   1374           targets
  3.3      2d4f890b7eddb390285e3afea9be98a078c2acd2fb311da8c9048e3d1e4864d3   1374           targets
  edge     878c1b1d668830f01c2b1622ebf1656e32ce830850775d26a387b2f11f541239   1374           targets
  latest   24a36bbc059b1345b7e8be0df20f1b23caa3602e85d42fff7ecd9d0bd255de56   1377           targets
</code></pre></div></div>

<p>The output shows us the names of the tags available, the hex encoded sha256
digest of the image manifest associated with that tag, the size of the manifest,
and the Notary role that signed this tag into the repository. The “targets” role
is the most common role in a simple repository. When a repository has (or
expects) to have collaborators, you may see other “delegated” roles listed as
signers, based on the choice of the administrator as to how they organize their
collaborators.</p>

<p>When you run a <code class="highlighter-rouge">docker pull</code> command, Docker Engine is using an integrated
Notary library (the same one as Notary CLI) to request the mapping of tag
to sha256 digest for the one tag you are interested in (or if you passed the
<code class="highlighter-rouge">--all</code> flag, the client uses the list operation to efficiently retrieve all
the mappings). Having validated the signatures on the trust data, the client
instructs the Engine to do a “pull by digest”. During this pull, the
Engine uses the sha256 checksum as a content address to request and validate the
image manifest from the Docker registry.</p>

<h2 id="delete-a-tag">Delete a tag</h2>

<p>Notary generates and stores signing keys on the host it’s running on. This means
that the Docker Hub cannot delete tags from the trust data, they must be deleted
using the Notary client. You can do this with the <code class="highlighter-rouge">notary remove</code> command.
Again, you must direct it to speak to the correct Notary server. Neither
you nor the author has permissions to delete tags from the official <code class="highlighter-rouge">alpine</code>
repository, so the output below is for demonstration only:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>notary <span class="nt">-s</span> https://notary.docker.io <span class="nt">-d</span> ~/.docker/trust remove docker.io/library/alpine 2.6
Removal of 2.6 from docker.io/library/alpine staged <span class="k">for </span>next publish.
</code></pre></div></div>

<p>In the preceding example, the output message indicates that only the removal was
staged. When performing any write operations they are staged into a change list.
This list is applied to the latest version of the trust repository the next time
a <code class="highlighter-rouge">notary publish</code> is run for that repository.</p>

<p>You can see a pending change by running <code class="highlighter-rouge">notary status</code> for the modified
repository. The <code class="highlighter-rouge">status</code> subcommand is an offline operation and as such, does
not require the <code class="highlighter-rouge">-s</code> flag, however it silently ignores the flag if provided.
Failing to provide the correct value for the <code class="highlighter-rouge">-d</code> flag may show the wrong
(probably empty) change list:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>notary <span class="nt">-d</span> ~/.docker/trust status docker.io/library/alpine
Unpublished changes <span class="k">for </span>docker.io/library/alpine:

action    scope     <span class="nb">type        </span>path
<span class="nt">----------------------------------------------------</span>
delete    targets   target      2.6
<span class="nv">$ </span>notary <span class="nt">-s</span> https://notary.docker.io publish docker.io/library/alpine
</code></pre></div></div>

<h2 id="configure-the-client">Configure the client</h2>

<p>It is verbose and tedious to always provide the <code class="highlighter-rouge">-s</code> and <code class="highlighter-rouge">-d</code> flags
manually to most commands. A simple way to create preconfigured versions of the
Notary command is via aliases. Add the following to your <code class="highlighter-rouge">.bashrc</code> or
equivalent:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">alias </span><span class="nv">dockernotary</span><span class="o">=</span><span class="s2">"notary -s https://notary.docker.io -d ~/.docker/trust"</span>
</code></pre></div></div>

<p>More advanced methods of configuration, and additional options, can be found in
the <a href="/docs.docker.jp.onthefly/notary/reference/">configuration doc</a> and by running <code class="highlighter-rouge">notary --help</code>.</p>

                            <!-- tags -->
                            
                            <span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span
                                style="vertical-align: 2px"><a
                                    href="https://docs.docker.com/search/?q=docker">docker</a>, <a
                                    href="https://docs.docker.com/search/?q=Notary">Notary</a>, <a
                                    href="https://docs.docker.com/search/?q=notary-client">notary-client</a>, <a
                                    href="https://docs.docker.com/search/?q=docker content trust">docker content trust</a>, <a
                                    href="https://docs.docker.com/search/?q=content trust">content trust</a></span>
                            
                            
                            <div id="ratings-div"
                                style="color:#b9c2cc; text-align: center; margin-top: 150px;">
                                <div id="pd_rating_holder_8453675"></div>
                                <script type="text/javascript">
                                    PDRTJS_settings_8453675 = {
                                        "id": "8453675",
                                        "unique_id": "notary/getting_started.md",
                                        "title": "Notary をはじめよう",
                                        "permalink": "https://github.com/docker/docker.github.io/blob/oligarch/notary/getting_started.md"
                                    };
                                    (function (d, c, j) {
                                        if (!document.getElementById(j)) {
                                            var pd = d.createElement(c),
                                                s;
                                            pd.id = j;
                                            pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
                                            s = document.getElementsByTagName(c)[0];
                                            s.parentNode.insertBefore(pd, s);
                                        }
                                    }(document, 'script', 'pd-rating-js'));
                                </script>
                            </div>
                            
                        </section>
                    </main>
                    <nav class="col-nav">
                        <div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
                            <div id="navbar" class="nav-sidebar">
    <ul class="nav jsTOCHorizontal hidden-md hidden-lg">
    </ul>
    <div class="divider hidden-md hidden-lg"></div>
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

                        </div>
                    </nav>
                    <div class="col-toc">
                        <div class="sidebar hidden-xs hidden-sm">
                            <div class="toc-nav">
                                <div class="feedback-links">
                                    <ul>
                                        
                                        <li><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/notary/getting_started.md"><i
                                                    class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
                                        <li><a href="https://github.com/matsuand/docs.docker.jp/issues/new?body=ファイル: [notary/getting_started.md](https://matsuand.github.io/docs.docker.jp.onthefly/notary/getting_started/)"
                                                class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
                                        <!-- toggle mode -->
                                        <li>
                                            <div class="toggle-mode">
                                                <div class="icon">
                                                    <i class="fa fa-sun-o" aria-hidden="true"></i>
                                                </div>
                                                <div class="toggle-switch">
                                                    <label class="switch">
                                                        <input type="checkbox" id="switch-style">
                                                        <div class="slider round"></div>
                                                    </label>
                                                </div>
                                                <div class="icon">
                                                    <i class="fa fa-moon-o" aria-hidden="true"></i>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                
                                
                                
                                
                                <div id="side-toc-title">本ページ内:</div>
                                
<ul id="my_toc" class="inline_toc">
  <li><a href="#what-is-notary" class="nomunge">Notary とは何か</a></li>
  <li><a href="#install-notary" class="nomunge">Notary のインストール</a></li>
  <li><a href="#understand-notary-naming" class="nomunge">Understand Notary naming</a></li>
  <li><a href="#inspect-a-docker-hub-repository" class="nomunge">Inspect a Docker Hub repository</a></li>
  <li><a href="#delete-a-tag" class="nomunge">Delete a tag</a></li>
  <li><a href="#configure-the-client" class="nomunge">Configure the client</a></li>
</ul>


                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    
    <footer class="footer">
          
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/why-docker">Why Docker?</a></b></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container?</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/overview">Products</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub">Docker Hub</a></li>
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Features</a></b></li>
                        <li><a href="https://www.docker.com/products/container-runtime">Container Runtime</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools">Developer Tools</a></li>
                        <li><a href="https://www.docker.com/products/kubernetes">Kubernetes</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Developers</a></b></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/play-with-docker">Play with Docker</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/open-source">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank">Company</a></b></li>
                        <li><a href="https://www.docker.com/company">About Us</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank">Blog</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners">Partners</a></li>
                        <li><a href="https://www.docker.com/company/newsroom">Newsroom</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2020 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

    </footer>
    <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/github.css">
    
    <script>var pageURL = "/notary/getting_started/";</script>
    <script defer src="/docs.docker.jp.onthefly/js/anchorlinks.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/menu.js"></script>
    <script src="/docs.docker.jp.onthefly/js/jquery.js"></script>
    <script src="/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
    <script src="/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/metadata.js"></script>
    <script src="/docs.docker.jp.onthefly/js/glossary.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/docs.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/toc.js"></script>
    <script defer src="/js/search.js"></script>
</body>


</html>
