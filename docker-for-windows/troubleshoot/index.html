<!-- Page generated 2020-07-16 21:49:37 +0900 -->
<!-- Logic for 'edit this button'


    

    

    

    

    

    

    

    

-->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <style type="text/css">
      @charset "UTF-8";
      [ng\:cloak],
      [ng-cloak],
      [data-ng-cloak],
      [x-ng-cloak],
      .ng-cloak,
      .x-ng-cloak,
      .ng-hide:not(.ng-hide-animate) {
          display: none !important;
      }

      ng\:form {
          display: block;
      }
  </style>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WL2QLG5');</script>

  
  <!-- favicon -->
  <link rel="icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta name="msapplication-TileImage" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico">
  <link rel="apple-touch-icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta property="og:image" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
  <!-- metadata -->
  <meta property="og:type" content="website"/>
  <meta property="og:updated_time" itemprop="dateUpdated" content="2020-07-16T21:49:37+09:00"/>
  <meta property="og:image" itemprop="image primaryImageOfPage" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:domain" content="docs.docker.com"/>
  <meta name="twitter:site" content="@docker_docs"/>
  <meta name="twitter:url" content="https://twitter.com/docker_docs"/>
  <meta name="twitter:title" itemprop="title name" content="Logs and troubleshooting"/>
  <meta name="twitter:description" property="og:description" itemprop="description" content="This page contains information on how to diagnose and troubleshoot problems, send logs and communicate with the Docker Desktop team, use our forums and Knowledge Hub, browse and log issues..." />
  <meta name="twitter:image:src" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:image:alt" content="Docker ドキュメント"/>
  <meta property="article:published_time" itemprop="datePublished" content="2020-07-16T21:49:37+09:00"/>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="windows, troubleshooting, logs, issues">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/font-awesome.min.css">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/bootstrap.min.css">
  <link id="pygments" rel="stylesheet" href="/docs.docker.jp.onthefly/css/pygments/perldoc.css">
  <link id="pagestyle" rel="stylesheet" href="/docs.docker.jp.onthefly/css/style.css">

  <!-- Go get "Open Sans" font from Google -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <!-- SEO stuff -->
  <title>Logs and troubleshooting | Docker ドキュメント</title>
  <meta property="og:title" content="Logs and troubleshooting" />
  <meta property="og:locale" content="ja_JP" />
  <meta name="description" content="Troubleshooting, logs, and known issues" />
  <meta property="og:description" content="Troubleshooting, logs, and known issues" />
  <link rel="canonical" href="/docker-for-windows/troubleshoot/" />
  <meta property="og:url" content="https://docs.docker.com/docker-for-windows/troubleshoot/" />
  <meta property="og:site_name" content="Docker ドキュメント" />
  <script type="application/ld+json">{"@context":"http://schema.org","@type":"WebPage","headline":"Logs and troubleshooting","description":"Troubleshooting, logs, and known issues","url":"https://docs.docker.com/docker-for-windows/troubleshoot/"}</script>
  <!-- END SEO STUFF -->
  
</head>


    <body ng-app="Docker" ng-controller="DockerController" class="colums">
    <header>
        <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/docs.docker.jp.onthefly/">
                <img class="logo" src="/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs">
            </a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="logo-mobile">
    <a href="/docs.docker.jp.onthefly/">
        <img src="/docs.docker.jp.onthefly/images/docker-icon.svg" alt="Docker Docs" title="Docker Docs">
    </a>
</div>
<div class="search-form" id="search-div">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container hidden-sm hidden-xs">
    <div id="tabs">
        <ul class="tabs jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
    </div>
</div>

        </div>
    </div>
</nav>

    </header>
    <div class="wrapper right-open">
        <div class="container-fluid">
            <div class="row">
                <div class="col-body">
                    <main class="col-content content">
                        <section class="section">
                            
                            
                            <h1>Logs and troubleshooting</h1> 
                            <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    17 分
  
</span>

                            
                            <p>This page contains information on how to diagnose and troubleshoot problems, send logs and communicate with the Docker Desktop team, use our forums and Knowledge Hub, browse and log issues on GitHub, and find workarounds for known problems.</p>

<h2 id="troubleshoot">Troubleshoot</h2>

<p>Choose <img src="/docs.docker.jp.onthefly/docker-for-windows/images/whale-x.png" alt="whale menu" class="inline" /> &gt; <strong>Troubleshoot</strong>
from the menu bar to see the troubleshoot options.</p>

<p><img src="/docs.docker.jp.onthefly/docker-for-windows/images/troubleshoot.png" alt="Uninstall or reset Docker" width="750px" /></p>

<p>The Troubleshoot page contains the following options:</p>

<ul>
  <li>
    <p><strong>Restart Docker Desktop</strong>: Select to restart Docker Desktop.</p>
  </li>
  <li>
    <p><strong>Run Diagnostics</strong>: Select this option to diagnose any issues on Docker Desktop. For detailed information about diagnostics, see <a href="#diagnose-problems-send-feedback-and-create-github-issues">Diagnose problems, send feedback, and create GitHub issues</a>.</p>
  </li>
  <li>
    <p><strong>Clean / Purge data</strong>: Select this option to delete container and image data. Choose whether you’d like to delete data from Hyper-V, WSL 2, or Windows Containers and then click <strong>Delete</strong> to confirm.</p>
  </li>
  <li>
    <p><strong>Reset Kubernetes cluster</strong>: Select this option to delete all stacks and Kubernetes resources. For more information, see <a href="/docs.docker.jp.onthefly/docker-for-windows/#kubernetes">Kubernetes</a>.</p>
  </li>
  <li>
    <p><strong>Reset to factory defaults</strong>: Choose this option to reset all options on
Docker Desktop to their initial state, the same as when Docker Desktop was first installed.</p>
  </li>
</ul>

<h2 id="diagnose-problems-send-feedback-and-create-github-issues">Diagnose problems, send feedback, and create GitHub issues</h2>

<h3 id="in-app-diagnostics">In-app diagnostics</h3>

<p>If you experience issues for which you do not find solutions in this
documentation, on <a href="https://github.com/docker/for-win/issues">Docker Desktop for Windows issues on
GitHub</a>, or the <a href="https://forums.docker.com/c/docker-for-windows">Docker Desktop for Windows
forum</a>, we can help you
troubleshoot the log data.</p>

<p>Choose <img src="/docs.docker.jp.onthefly/docker-for-windows/images/whale-x.png" alt="whale menu" class="inline" /> &gt; <strong>Troubleshoot</strong>
from the menu.</p>

<p><img src="/docs.docker.jp.onthefly/docker-for-windows/images/diagnose-feedback.png" alt="Diagnose &amp; Feedback" width="600px" /></p>

<p>When the <strong>Diagnose &amp; Feedback</strong> window initiated, it starts collecting diagnostics. When the diagnostics are available, you can upload them and obtain a <strong>Diagnostic ID</strong>, which must be provided when communicating with the Docker
team. For more information on our policy regarding personal data, see
<a href="https://docs.docker.com/docker-for-mac/faqs/#how-is-personal-data-handled-in-docker-desktop">how is personal data handled in Docker
Desktop</a>.</p>

<p><img src="/docs.docker.jp.onthefly/docker-for-windows/images/diagnostic-id.png" alt="Diagnose &amp; Feedback with ID" width="600px" /></p>

<p>If you click on <strong>Report an issue</strong>, it opens <a href="https://github.com/docker/for-win/issues/">Docker Desktop for Windows issues on
GitHub</a> in your web browser in a
“New issue” template, to be completed before submission. Do not forget to
include your diagnostic ID.</p>

<p><img src="/docs.docker.jp.onthefly/docker-for-windows/images/issue-template.png" alt="issue-template" width="600px" /></p>

<h3 id="diagnosing-from-the-terminal">Diagnosing from the terminal</h3>

<p>On occasions it is useful to run the diagnostics yourself, for instance if
Docker Desktop for Windows cannot start.</p>

<p>First locate the <code class="highlighter-rouge">com.docker.diagnose</code>, that should be in <code class="highlighter-rouge">C:\Program
Files\Docker\Docker\resources\com.docker.diagnose.exe</code>.</p>

<p>To create <em>and upload</em>  diagnostics in Powershell, run:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">PS </span>C:\&gt; &amp; <span class="s2">"C:\Program Files\Docker\Docker\resources\com.docker.diagnose.exe"</span> gather -upload
</code></pre></div></div>

<p>After the diagnostics have finished, you should have the following output,
containing your diagnostic ID:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Diagnostics Bundle: C:<span class="se">\U</span>sers<span class="se">\U</span>ser<span class="se">\A</span>ppData<span class="se">\L</span>ocal<span class="se">\T</span>emp<span class="se">\C</span>D6CF862-9CBD-4007-9C2F-5FBE0572BBC2<span class="se">\2</span>0180720152545.zip
Diagnostics ID:     CD6CF862-9CBD-4007-9C2F-5FBE0572BBC2/20180720152545 <span class="o">(</span>uploaded<span class="o">)</span>
</code></pre></div></div>

<h2 id="troubleshooting-topics">Troubleshooting topics</h2>

<h3 id="make-sure-certificates-are-set-up-correctly">Make sure certificates are set up correctly</h3>

<p>Docker Desktop ignores certificates listed under insecure registries, and
does not send client certificates to them. Commands like <code class="highlighter-rouge">docker run</code> that
attempt to pull from the registry produces error messages on the command line,
like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Error response from daemon: Get http://192.168.203.139:5858/v2/: malformed HTTP response "\x15\x03\x01\x00\x02\x02"
</code></pre></div></div>

<p>As well as on the registry. For example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2017/06/20 18:15:30 http: TLS handshake error from 192.168.203.139:52882: tls: client didn't provide a certificate
2017/06/20 18:15:30 http: TLS handshake error from 192.168.203.139:52883: tls: first record does not look like a TLS handshake
</code></pre></div></div>

<p>For more about using client and server side certificates, see
<a href="/docs.docker.jp.onthefly/docker-for-windows/#how-do-i-add-custom-ca-certificates">How do I add custom CA certificates?</a>
and <a href="/docs.docker.jp.onthefly/docker-for-windows/#how-do-i-add-client-certificates">How do I add client certificates?</a> in the
Getting Started topic.</p>

<h3 id="volumes">Volumes</h3>

<h4 id="permissions-errors-on-data-directories-for-shared-volumes">Permissions errors on data directories for shared volumes</h4>

<p>Docker Desktop sets permissions on <a href="/docs.docker.jp.onthefly/docker-for-windows/#file-sharing">shared volumes</a>
to a default value of <a href="http://permissions-calculator.org/decode/0777/">0777</a>
(<code class="highlighter-rouge">read</code>, <code class="highlighter-rouge">write</code>, <code class="highlighter-rouge">execute</code> permissions for <code class="highlighter-rouge">user</code> and for <code class="highlighter-rouge">group</code>).</p>

<p>The default permissions on shared volumes are not configurable. If you are
working with applications that require permissions different from the shared
volume defaults at container runtime, you need to either use non-host-mounted
volumes or find a way to make the applications work with the default file
permissions.</p>

<p>See also,
<a href="/docs.docker.jp.onthefly/docker-for-windows/faqs/#can-i-change-permissions-on-shared-volumes-for-container-specific-deployment-requirements">Can I change permissions on shared volumes for container-specific deployment requirements?</a>
in the FAQs.</p>

<h4 id="volume-mounting-requires-shared-folders-for-linux-containers">Volume mounting requires shared folders for Linux containers</h4>

<p>If you are using mounted volumes and get runtime errors indicating an
application file is not found, access is denied to a volume mount, or a service
cannot start, such as when using <a href="/docs.docker.jp.onthefly/compose/gettingstarted/">Docker Compose</a>,
you might need to enable <a href="/docs.docker.jp.onthefly/docker-for-windows/#file-sharing">shared folders</a>.</p>

<p>Volume mounting requires shared folders for Linux containers (not for Windows
containers). Click <img src="/docs.docker.jp.onthefly/docker-for-windows/images/whale-x.png" alt="whale menu" class="inline" />
 and then <strong>Settings</strong> &gt; <strong>Shared Folders</strong> and share the folder that contains the
Dockerfile and volume.</p>

<h4 id="support-for-symlinks">Support for symlinks</h4>

<p>Symlinks work within and across containers. To learn more, see <a href="/docs.docker.jp.onthefly/docker-for-windows/faqs/#how-do-symlinks-work-on-windows">How do symlinks work on Windows?</a> in the FAQs.</p>

<h4 id="avoid-unexpected-syntax-errors-use-unix-style-line-endings-for-files-in-containers">Avoid unexpected syntax errors, use Unix style line endings for files in containers</h4>

<p>Any file destined to run inside a container must use Unix style <code class="highlighter-rouge">\n</code> line
endings. This includes files referenced at the command line for builds and in
RUN commands in Docker files.</p>

<p>Docker containers and <code class="highlighter-rouge">docker build</code> run in a Unix environment, so files in
containers must use Unix style line endings: <code class="highlighter-rouge">\n</code>, <em>not</em> Windows style: <code class="highlighter-rouge">\r\n</code>.
Keep this in mind when authoring files such as shell scripts using Windows
tools, where the default is likely to be Windows style line endings. These
commands ultimately get passed to Unix commands inside a Unix based container
(for example, a shell script passed to <code class="highlighter-rouge">/bin/sh</code>). If Windows style line endings
are used, <code class="highlighter-rouge">docker run</code> fails with syntax errors.</p>

<p>For an example of this issue and the resolution, see this issue on GitHub:
<a href="https://github.com/moby/moby/issues/24388">Docker RUN fails to execute shell
script</a>.</p>

<h3 id="virtualization">Virtualization</h3>

<p>Your machine must have the following features for Docker Desktop to function correctly:</p>

<ol>
  <li>
    <p><a href="https://docs.microsoft.com/en-us/windows-server/virtualization/hyper-v/hyper-v-technology-overview">Hyper-V</a>
installed and working</p>
  </li>
  <li>
    <p>Virtualization enabled in the BIOS</p>
  </li>
</ol>

<h4 id="hyper-v">Hyper-V</h4>

<p>Docker Desktop requires Hyper-V as well as the Hyper-V Module for Windows
Powershell to be installed and enabled. The Docker Desktop installer enables
it for you.</p>

<p>Docker Desktop also needs two CPU hardware features to use Hyper-V: Virtualization and Second Level Address Translation (SLAT), which is also called Rapid Virtualization Indexing (RVI). On some systems, Virtualization must be enabled in the BIOS. The steps required are vendor-specific, but typically the BIOS option is called <code class="highlighter-rouge">Virtualization Technology (VTx)</code> or something similar. Run the command <code class="highlighter-rouge">systeminfo</code> to check all required Hyper-V features. See <a href="https://docs.microsoft.com/en-us/virtualization/hyper-v-on-windows/reference/hyper-v-requirements">Pre-requisites for Hyper-V on Windows 10</a> for more details.</p>

<p>To install Hyper-V manually, see <a href="https://msdn.microsoft.com/en-us/virtualization/hyperv_on_windows/quick_start/walkthrough_install">Install Hyper-V on Windows 10</a>. A reboot is <em>required</em> after installation. If you install Hyper-V without rebooting, Docker Desktop does not work correctly.</p>

<p>From the start menu, type <strong>Turn Windows features on or off</strong> and press enter.
In the subsequent screen, verify that Hyper-V is enabled:</p>

<p><img src="/docs.docker.jp.onthefly/docker-for-windows/images/hyperv-enabled.png" alt="Hyper-V on Windows features" width="600px" /></p>

<h4 id="hyper-v-driver-for-docker-machine">Hyper-V driver for Docker Machine</h4>

<p>The Docker Desktop installation includes the legacy tool Docker Machine which uses the old
<a href="https://github.com/boot2docker/boot2docker" target="_blank" class="_"><code class="highlighter-rouge">boot2docker.iso</code></a>,
and the <a href="/docs.docker.jp.onthefly/machine/drivers/hyper-v/">Microsoft Hyper-V driver</a> to create local
virtual machines. <em>This is tangential to using Docker Desktop</em>, but if you want to use Docker Machine
to create multiple local Virtual Machines (VMs), or to provision remote machines, see the
<a href="/docs.docker.jp.onthefly/machine/">Docker Machine</a> topics. This is documented only for users looking for information about Docker Machine on Windows, which requires that Hyper-V is enabled, an external network switch is active, and referenced in the flags for the <code class="highlighter-rouge">docker-machine create</code> command
as described in the <a href="/docs.docker.jp.onthefly/machine/drivers/hyper-v/#example">Docker Machine driver example</a>.</p>

<h4 id="virtualization-must-be-enabled">Virtualization must be enabled</h4>

<p>In addition to <a href="#hyper-v">Hyper-V</a> or <a href="/docs.docker.jp.onthefly/docker-for-windows/wsl/">WSL 2</a>, virtualization must be enabled. Check the
Performance tab on the Task Manager:</p>

<p><img src="/docs.docker.jp.onthefly/docker-for-windows/images/virtualization-enabled.png" alt="Task Manager" width="700px" /></p>

<p>If you manually uninstall Hyper-V, WSL 2 or disable virtualization,
Docker Desktop cannot start. See <a href="https://github.com/docker/for-win/issues/74">Unable to run Docker for Windows on
Windows 10 Enterprise</a>.</p>

<h3 id="networking-and-wifi-problems-upon-docker-desktop-for-windows-install">Networking and WiFi problems upon Docker Desktop for Windows install</h3>

<p>Some users may experience networking issues during install and startup of
Docker Desktop. For example, upon install or auto-reboot, network adapters
and/or WiFi may get disabled. In some scenarios, problems are due to having
VirtualBox or its network adapters still installed, but in other scenarios this
is not the case. See the GitHub issue <a href="https://github.com/docker/for-win/issues/139">Enabling
Hyper-V feature turns my wi-fi
off</a>.</p>

<p>Here are some steps to take if you experience similar problems:</p>

<ol>
  <li>
    <p>Ensure <strong>virtualization</strong> is enabled, as described above in <a href="#virtualization-must-be-enabled">Virtualization
must be enabled</a>.</p>
  </li>
  <li>
    <p>Ensure <strong>Hyper-V</strong> is installed and enabled, as described above in <a href="#hyper-v-must-be-enabled">Hyper-V
must be enabled</a>.</p>
  </li>
  <li>
    <p>Ensure <strong>DockerNAT</strong> is enabled by checking the <strong>Virtual Switch Manager</strong>
on the Actions tab on the right side of the <strong>Hyper-V Manager</strong>.</p>

    <p><img src="/docs.docker.jp.onthefly/docker-for-windows/images/hyperv-manager.png" alt="Hyper-V manager" /></p>
  </li>
  <li>
    <p>Set up an external network switch. If you plan at any point to use
<a href="/docs.docker.jp.onthefly/machine/overview/">Docker Machine</a> to set up multiple local VMs, you
need this anyway, as described in the topic on the
<a href="/docs.docker.jp.onthefly/machine/drivers/hyper-v/#example">Hyper-V driver for Docker Machine</a>.
You can replace <code class="highlighter-rouge">DockerNAT</code> with this switch.</p>
  </li>
  <li>
    <p>If previous steps fail to solve the problems, follow steps on the
<a href="https://github.com/Microsoft/Virtualization-Documentation/blob/oligarch/windows-server-container-tools/CleanupContainerHostNetworking/README.md">Cleanup README</a>.</p>

    <blockquote>
      <p>Read the full description before you run the Windows cleanup script.</p>

      <p>The cleanup command has two flags, <code class="highlighter-rouge">-Cleanup</code> and
<code class="highlighter-rouge">-ForceDeleteAllSwitches</code>. Read the whole page before running any scripts,
especially warnings about <code class="highlighter-rouge">-ForceDeleteAllSwitches</code>. {: .warning}</p>
    </blockquote>
  </li>
</ol>

<h3 id="windows-containers-and-windows-server">Windows containers and Windows Server</h3>

<p>Docker Desktop is not supported on Windows Server. If you have questions about how to run Windows containers on Windows 10, see
<a href="/docs.docker.jp.onthefly/docker-for-windows/#switch-between-windows-and-linux-containers">Switch between Windows and Linux containers</a>.</p>

<p>A full tutorial is available in <a href="https://github.com/docker/labs">docker/labs</a> on
<a href="https://github.com/docker/labs/blob/oligarch/windows/windows-containers/README.md">Getting Started with Windows Containers</a>.</p>

<p>You can install a native Windows binary which allows you to develop and run
Windows containers without Docker Desktop. However, if you install Docker this way, you cannot develop or run Linux containers. If you try to run a Linux container on the native Docker daemon, an error occurs:</p>

<pre><code class="language-none">C:\Program Files\Docker\docker.exe:
 image operating system "linux" cannot be used on this platform.
 See 'C:\Program Files\Docker\docker.exe run --help'.
</code></pre>

<h3 id="limitations-of-windows-containers-for-localhost-and-published-ports">Limitations of Windows containers for <code class="highlighter-rouge">localhost</code> and published ports</h3>

<p>Docker Desktop for Windows provides the option to switch Windows and Linux containers.
If you are using Windows containers, keep in mind that there are some
limitations with regard to networking due to the current implementation of
Windows NAT (WinNAT). These limitations may potentially resolve as the Windows
containers project evolves.</p>

<p>Windows containers work with published ports on localhost beginning with Windows 10 1809 using Docker Desktop for Windows as well as Windows Server 2019 / 1809 using Docker EE.</p>

<p>If you are working with a version prior to <code class="highlighter-rouge">Windows 10 18.09</code>, published ports on Windows containers have an issue with loopback to the localhost. You can only reach container endpoints from the host using the container’s IP and port. With <code class="highlighter-rouge">Windows 10 18.09</code>, containers work with published ports on localhost.</p>

<p>So, in a scenario where you use Docker to pull an image and run a webserver with
a command like this:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> docker run <span class="nt">-d</span> <span class="nt">-p</span> 80:80 <span class="nt">--name</span> webserver nginx
</code></pre></div></div>

<p>Using <code class="highlighter-rouge">curl http://localhost</code>, or pointing your web browser at
<code class="highlighter-rouge">http://localhost</code> does not display the <code class="highlighter-rouge">nginx</code> web page (as it would do with
Linux containers).</p>

<p>To reach a Windows container from the local host, you need to specify the IP
address and port for the container that is running the service.</p>

<p>You can get the container IP address by using <a href="/docs.docker.jp.onthefly/engine/reference/commandline/inspect/"><code class="highlighter-rouge">docker inspect</code></a> with some <code class="highlighter-rouge">--format</code> options
and the ID or name of the container. For the example above, the command would
look like this, using the name we gave to the container (<code class="highlighter-rouge">webserver</code>) instead of
the container ID:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker inspect <span class="se">\</span>
  <span class="nt">--format</span><span class="o">=</span><span class="s1">'{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}'</span> <span class="se">\</span>
  webserver
</code></pre></div></div>

<p>This gives you the IP address of the container, for example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker inspect <span class="se">\</span>
  <span class="nt">--format</span><span class="o">=</span><span class="s1">'{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}'</span> <span class="se">\</span>
  webserver

172.17.0.2
</code></pre></div></div>

<p>Now you can connect to the webserver by using <code class="highlighter-rouge">http://172.17.0.2:80</code> (or simply
<code class="highlighter-rouge">http://172.17.0.2</code>, since port <code class="highlighter-rouge">80</code> is the default HTTP port.)</p>

<p>For more information, see:</p>

<ul>
  <li>
    <p>Docker Desktop for Windows issue on GitHub: <a href="https://github.com/docker/for-win/issues/458">Port binding does not work for
locahost</a></p>
  </li>
  <li>
    <p><a href="https://blog.sixeyed.com/published-ports-on-windows-containers-dont-do-loopback/">Published Ports on Windows Containers Don’t Do
Loopback</a></p>
  </li>
  <li>
    <p><a href="https://blogs.technet.microsoft.com/virtualization/2016/05/25/windows-nat-winnat-capabilities-and-limitations/">Windows NAT capabilities and
limitations</a></p>
  </li>
</ul>

<h3 id="running-docker-desktop-in-nested-virtualization-scenarios">Running Docker Desktop in nested virtualization scenarios</h3>

<p>Docker Desktop can run inside a Windows 10 VM running on apps like Parallels or VMware Fusion on a Mac provided that the VM is properly configured. However, problems and intermittent failures may still occur due to the way these apps virtualize the hardware. For these reasons, <em><strong>Docker Desktop is not supported in nested virtualization scenarios</strong></em>. It might work
in some cases, and not in others.</p>

<p>For best results, we recommend you run Docker Desktop natively on a Windows system (to work with Windows or Linux containers), or on Mac to work with Linux containers.</p>

<h4 id="if-you-still-want-to-use-nested-virtualization">If you still want to use nested virtualization</h4>

<ul>
  <li>
    <p>Make sure nested virtualization support is enabled in VMWare or Parallels.
Check the settings in <strong>Hardware &gt; CPU &amp; Memory &gt; Advanced Options &gt; Enable
nested virtualization</strong> (the exact menu sequence might vary slightly).</p>
  </li>
  <li>
    <p>Configure your VM with at least 2 CPUs and sufficient memory to run your
workloads.</p>
  </li>
  <li>
    <p>Make sure your system is more or less idle.</p>
  </li>
  <li>
    <p>Make sure your Windows OS is up-to-date. There have been several issues with
some insider builds.</p>
  </li>
  <li>
    <p>The processor you have may also be relevant. For example, Westmere based Mac
Pros have some additional hardware virtualization features over Nehalem based
Mac Pros and so do newer generations of Intel processors.</p>
  </li>
</ul>

<h4 id="typical-failures-we-see-with-nested-virtualization">Typical failures we see with nested virtualization</h4>

<ul>
  <li>
    <p>Slow boot time of the Linux VM. If you look in the logs and find some entries
prefixed with <code class="highlighter-rouge">Moby</code>. On real hardware, it takes 5-10 seconds to boot the
Linux VM; roughly the time between the <code class="highlighter-rouge">Connected</code> log entry and the <code class="highlighter-rouge">*
Starting Docker ... [ ok ]</code> log entry. If you boot the Linux VM inside a
Windows VM, this may take considerably longer. We have a timeout of 60s or so.
If the VM hasn’t started by that time, we retry. If the retry fails we print
an error. You can sometimes work around this by providing more resources to
the Windows VM.</p>
  </li>
  <li>
    <p>Sometimes the VM fails to boot when Linux tries to calibrate the time stamp
counter (TSC). This process is quite timing sensitive and may fail when
executed inside a VM which itself runs inside a VM. CPU utilization is also
likely to be higher.</p>
  </li>
  <li>
    <p>Ensure “PMU Virtualization” is turned off in Parallels on Macs. Check the
settings in <strong>Hardware &gt; CPU &amp; Memory &gt; Advanced Settings &gt; PMU
Virtualization</strong>.</p>
  </li>
</ul>

<h4 id="related-issues">Related issues</h4>

<p>Discussion thread on GitHub at <a href="https://github.com/docker/for-win/issues/267">Docker for Windows issue
267</a>.</p>

<h3 id="networking-issues">Networking issues</h3>

<p>IPv6 is not (yet) supported on Docker Desktop.</p>

<p>Some users have reported problems connecting to Docker Hub on the Docker Desktop stable version. (See GitHub issue
<a href="https://github.com/moby/moby/issues/22567">22567</a>.)</p>

<p>Here is an example command and error message:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> docker run hello-world

Unable to find image <span class="s1">'hello-world:latest'</span> locally
Pulling repository docker.io/library/hello-world
C:<span class="se">\P</span>rogram Files<span class="se">\D</span>ocker<span class="se">\D</span>ocker<span class="se">\R</span>esources<span class="se">\b</span><span class="k">in</span><span class="se">\d</span>ocker.exe: Error <span class="k">while </span>pulling image: Get https://index.docker.io/v1/repositories/library/hello-world/images: dial tcp: lookup index.docker.io on 10.0.75.1:53: no such host.
See <span class="s1">'C:\Program Files\Docker\Docker\Resources\bin\docker.exe run --help'</span><span class="nb">.</span>
</code></pre></div></div>

<p>As an immediate workaround to this problem, reset the DNS server to use the
Google DNS fixed address: <code class="highlighter-rouge">8.8.8.8</code>. You can configure this through the <strong>Settings</strong></p>
<blockquote>
  <p><strong>Network</strong> dialog, as described in the topic <a href="/docs.docker.jp.onthefly/docker-for-windows/#network">Network</a>.
Docker automatically restarts when you apply this setting, which could take some
time.</p>
</blockquote>

<h3 id="natip-configuration">NAT/IP configuration</h3>

<p>By default, Docker Desktop uses an internal network prefix of
<code class="highlighter-rouge">10.0.75.0/24</code>. Should this clash with your normal network setup, you can change
the prefix from the <strong>Settings</strong> menu. See the <a href="/docs.docker.jp.onthefly/docker-for-windows/#network">Network</a> topic
under <a href="/docs.docker.jp.onthefly/docker-for-windows/#docker-settings">Settings</a>.</p>

<h2 id="workarounds">Workarounds</h2>

<h3 id="reboot">Reboot</h3>

<p>Restart your PC to stop / discard any vestige of the daemon running from the
previously installed version.</p>

<h3 id="unset-docker_host">Unset <code class="highlighter-rouge">DOCKER_HOST</code></h3>

<p>The <code class="highlighter-rouge">DOCKER_HOST</code> environmental variable does not need to be set.  If you use
bash, use the command <code class="highlighter-rouge">unset ${!DOCKER_*}</code> to unset it.  For other shells,
consult the shell’s documentation.</p>

<h3 id="make-sure-docker-is-running-for-webserver-examples">Make sure Docker is running for webserver examples</h3>

<p>For the <code class="highlighter-rouge">hello-world-nginx</code> example and others, Docker Desktop must be
running to get to the webserver on <code class="highlighter-rouge">http://localhost/</code>. Make sure that the
Docker whale is showing in the menu bar, and that you run the Docker commands in
a shell that is connected to the Docker Desktop Engine (not Engine from Toolbox). Otherwise, you might start the webserver container but get a “web page
not available” error when you go to <code class="highlighter-rouge">docker</code>.</p>

<h3 id="how-to-solve-port-already-allocated-errors">How to solve <code class="highlighter-rouge">port already allocated</code> errors</h3>

<p>If you see errors like <code class="highlighter-rouge">Bind for 0.0.0.0:8080 failed: port is already allocated</code>
or <code class="highlighter-rouge">listen tcp:0.0.0.0:8080: bind: address is already in use</code> ...</p>

<p>These errors are often caused by some other software on Windows using those
ports. To discover the identity of this software, either use the <code class="highlighter-rouge">resmon.exe</code>
GUI and click “Network” and then “Listening Ports” or in a Powershell use
<code class="highlighter-rouge">netstat -aon | find /i "listening "</code> to discover the PID of the process
currently using the port (the PID is the number in the rightmost column). Decide
whether to shut the other process down, or to use a different port in your
docker app.</p>

<h3 id="docker-desktop-fails-to-start-when-anti-virus-software-is-installed">Docker Desktop fails to start when anti-virus software is installed</h3>

<p>Some anti-virus software may be incompatible with Hyper-V and Microsoft
Windows 10 builds. The conflict
typically occurs after a Windows update and
manifests as an error response from the Docker daemon and a Docker Desktop start failure.</p>

<p>For a temporary workaround, uninstall the anti-virus software, or
explore other workarounds suggested on Docker Desktop forums.</p>

                            <!-- tags -->
                            
                            <span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span
                                style="vertical-align: 2px"><a
                                    href="https://docs.docker.com/search/?q=windows">windows</a>, <a
                                    href="https://docs.docker.com/search/?q=troubleshooting">troubleshooting</a>, <a
                                    href="https://docs.docker.com/search/?q=logs">logs</a>, <a
                                    href="https://docs.docker.com/search/?q=issues">issues</a></span>
                            
                            
                            <div id="ratings-div"
                                style="color:#b9c2cc; text-align: center; margin-top: 150px;">
                                <div id="pd_rating_holder_8453675"></div>
                                <script type="text/javascript">
                                    PDRTJS_settings_8453675 = {
                                        "id": "8453675",
                                        "unique_id": "docker-for-windows/troubleshoot.md",
                                        "title": "Logs and troubleshooting",
                                        "permalink": "https://github.com/docker/docker.github.io/blob/oligarch/docker-for-windows/troubleshoot.md"
                                    };
                                    (function (d, c, j) {
                                        if (!document.getElementById(j)) {
                                            var pd = d.createElement(c),
                                                s;
                                            pd.id = j;
                                            pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
                                            s = document.getElementsByTagName(c)[0];
                                            s.parentNode.insertBefore(pd, s);
                                        }
                                    }(document, 'script', 'pd-rating-js'));
                                </script>
                            </div>
                            
                        </section>
                    </main>
                    <nav class="col-nav">
                        <div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
                            <div id="navbar" class="nav-sidebar">
    <ul class="nav jsTOCHorizontal hidden-md hidden-lg">
    </ul>
    <div class="divider hidden-md hidden-lg"></div>
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

                        </div>
                    </nav>
                    <div class="col-toc">
                        <div class="sidebar hidden-xs hidden-sm">
                            <div class="toc-nav">
                                <div class="feedback-links">
                                    <ul>
                                        
                                        <li><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/docker-for-windows/troubleshoot.md"><i
                                                    class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
                                        <li><a href="https://github.com/matsuand/docs.docker.jp/issues/new?body=ファイル: [docker-for-windows/troubleshoot.md](https://matsuand.github.io/docs.docker.jp.onthefly/docker-for-windows/troubleshoot/)"
                                                class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
                                        <!-- toggle mode -->
                                        <li>
                                            <div class="toggle-mode">
                                                <div class="icon">
                                                    <i class="fa fa-sun-o" aria-hidden="true"></i>
                                                </div>
                                                <div class="toggle-switch">
                                                    <label class="switch">
                                                        <input type="checkbox" id="switch-style">
                                                        <div class="slider round"></div>
                                                    </label>
                                                </div>
                                                <div class="icon">
                                                    <i class="fa fa-moon-o" aria-hidden="true"></i>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                
                                
                                
                                
                                <div id="side-toc-title">本ページ内:</div>
                                
<ul id="my_toc" class="inline_toc">
  <li><a href="#troubleshoot" class="nomunge">Troubleshoot</a></li>
  <li><a href="#diagnose-problems-send-feedback-and-create-github-issues" class="nomunge">Diagnose problems, send feedback, and create GitHub issues</a>
    <ul>
      <li><a href="#in-app-diagnostics" class="nomunge">In-app diagnostics</a></li>
      <li><a href="#diagnosing-from-the-terminal" class="nomunge">Diagnosing from the terminal</a></li>
    </ul>
  </li>
  <li><a href="#troubleshooting-topics" class="nomunge">Troubleshooting topics</a>
    <ul>
      <li><a href="#make-sure-certificates-are-set-up-correctly" class="nomunge">Make sure certificates are set up correctly</a></li>
      <li><a href="#volumes" class="nomunge">Volumes</a></li>
      <li><a href="#virtualization" class="nomunge">Virtualization</a></li>
      <li><a href="#networking-and-wifi-problems-upon-docker-desktop-for-windows-install" class="nomunge">Networking and WiFi problems upon Docker Desktop for Windows install</a></li>
      <li><a href="#windows-containers-and-windows-server" class="nomunge">Windows containers and Windows Server</a></li>
      <li><a href="#limitations-of-windows-containers-for-localhost-and-published-ports" class="nomunge">Limitations of Windows containers for localhost and published ports</a></li>
      <li><a href="#running-docker-desktop-in-nested-virtualization-scenarios" class="nomunge">Running Docker Desktop in nested virtualization scenarios</a></li>
      <li><a href="#networking-issues" class="nomunge">Networking issues</a></li>
      <li><a href="#natip-configuration" class="nomunge">NAT/IP configuration</a></li>
    </ul>
  </li>
  <li><a href="#workarounds" class="nomunge">Workarounds</a>
    <ul>
      <li><a href="#reboot" class="nomunge">Reboot</a></li>
      <li><a href="#unset-docker_host" class="nomunge">Unset DOCKER_HOST</a></li>
      <li><a href="#make-sure-docker-is-running-for-webserver-examples" class="nomunge">Make sure Docker is running for webserver examples</a></li>
      <li><a href="#how-to-solve-port-already-allocated-errors" class="nomunge">How to solve port already allocated errors</a></li>
      <li><a href="#docker-desktop-fails-to-start-when-anti-virus-software-is-installed" class="nomunge">Docker Desktop fails to start when anti-virus software is installed</a></li>
    </ul>
  </li>
</ul>


                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    
    <footer class="footer">
          
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/why-docker">Why Docker?</a></b></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container?</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/overview">Products</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub">Docker Hub</a></li>
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Features</a></b></li>
                        <li><a href="https://www.docker.com/products/container-runtime">Container Runtime</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools">Developer Tools</a></li>
                        <li><a href="https://www.docker.com/products/kubernetes">Kubernetes</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Developers</a></b></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/play-with-docker">Play with Docker</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/open-source">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank">Company</a></b></li>
                        <li><a href="https://www.docker.com/company">About Us</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank">Blog</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners">Partners</a></li>
                        <li><a href="https://www.docker.com/company/newsroom">Newsroom</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2020 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

    </footer>
    <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/github.css">
    
    <script>var pageURL = "/docker-for-windows/troubleshoot/";</script>
    <script defer src="/docs.docker.jp.onthefly/js/anchorlinks.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/menu.js"></script>
    <script src="/docs.docker.jp.onthefly/js/jquery.js"></script>
    <script src="/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
    <script src="/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/metadata.js"></script>
    <script src="/docs.docker.jp.onthefly/js/glossary.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/docs.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/toc.js"></script>
    <script defer src="/js/search.js"></script>
</body>


</html>
